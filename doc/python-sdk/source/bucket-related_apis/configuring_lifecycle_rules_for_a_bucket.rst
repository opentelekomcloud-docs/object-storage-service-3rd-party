:original_name: obs_22_0821.html

.. _obs_22_0821:

Configuring Lifecycle Rules for a Bucket
========================================

Function
--------

You can configure lifecycle rules to periodically delete objects or transition objects between storage classes.

This API configures lifecycle rules for a bucket.

.. note::

   -  Expired objects will be permanently deleted and cannot be recovered.
   -  Multi-AZ redundancy is not available for Cold storage. For this reason, buckets or objects with multi-AZ redundancy cannot be transitioned to the Cold storage class based on a lifecycle rule.
   -  The minimum storage duration is 30 days for Warm storage, and 90 days for Cold storage. After an object is transitioned to the Cold storage class, if it stays in this storage class for less than 90 days, you still need to pay for a full 90 days.

Restrictions
------------

-  There is no limit on the number of lifecycle rules in a bucket, but the total size of XML descriptions about all lifecycle rules in a bucket cannot exceed 20 KB.
-  A maximum of 20 lifecycle rules can be configured for a parallel file system.
-  To configure a lifecycle rule for a bucket, you must be the bucket owner or have the required permission (**obs:bucket:PutLifecycleConfiguration** in IAM or **PutLifecycleConfiguration** in a bucket policy).

Method
------

ObsClient.setBucketLifecycle(bucketName, lifecycle, extensionHeaders)

Request Parameters
------------------

+------------------+----------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Parameter        | Type                                                                 | Mandatory (Yes/No) | Description                                                                                                                                                                       |
+==================+======================================================================+====================+===================================================================================================================================================================================+
| bucketName       | str                                                                  | Yes                | **Explanation:**                                                                                                                                                                  |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | Bucket name                                                                                                                                                                       |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | **Restrictions:**                                                                                                                                                                 |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | -  A bucket name must be unique across all accounts and regions.                                                                                                                  |
|                  |                                                                      |                    | -  A bucket name:                                                                                                                                                                 |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    |    -  Must be 3 to 63 characters long and start with a digit or letter. Lowercase letters, digits, hyphens (-), and periods (.) are allowed.                                      |
|                  |                                                                      |                    |    -  Cannot be formatted as an IP address.                                                                                                                                       |
|                  |                                                                      |                    |    -  Cannot start or end with a hyphen (-) or period (.).                                                                                                                        |
|                  |                                                                      |                    |    -  Cannot contain two consecutive periods (..), for example, **my..bucket**.                                                                                                   |
|                  |                                                                      |                    |    -  Cannot contain periods (.) and hyphens (-) adjacent to each other, for example, **my-.bucket** or **my.-bucket**.                                                           |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | -  If you repeatedly create buckets of the same name in the same region, no error will be reported and the bucket properties comply with those set in the first creation request. |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | **Default value**:                                                                                                                                                                |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | None                                                                                                                                                                              |
+------------------+----------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| lifecycle        | :ref:`Lifecycle <obs_22_0821__en-us_topic_0142814712_table14455523>` | Yes                | **Explanation:**                                                                                                                                                                  |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | List of lifecycle rules. For details, see :ref:`Table 1 <obs_22_0821__en-us_topic_0142814712_table14455523>`.                                                                     |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | **Default value**:                                                                                                                                                                |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | None                                                                                                                                                                              |
+------------------+----------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| extensionHeaders | dict                                                                 | No                 | **Explanation:**                                                                                                                                                                  |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | Extension headers.                                                                                                                                                                |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | **Value range**:                                                                                                                                                                  |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | See :ref:`User-defined Headers <obs_22_1305>`.                                                                                                                                    |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | **Default value**:                                                                                                                                                                |
|                  |                                                                      |                    |                                                                                                                                                                                   |
|                  |                                                                      |                    | None                                                                                                                                                                              |
+------------------+----------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__en-us_topic_0142814712_table14455523:

.. table:: **Table 1** Lifecycle

   +-----------------+-------------------------------------------------------------------------+--------------------+---------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type                                                                    | Mandatory (Yes/No) | Description                                                                                                   |
   +=================+=========================================================================+====================+===============================================================================================================+
   | rule            | list of :ref:`Rule <obs_22_0821__en-us_topic_0142814614_table14455523>` | Yes                | **Explanation:**                                                                                              |
   |                 |                                                                         |                    |                                                                                                               |
   |                 |                                                                         |                    | List of lifecycle rules. For details, see :ref:`Table 2 <obs_22_0821__en-us_topic_0142814614_table14455523>`. |
   |                 |                                                                         |                    |                                                                                                               |
   |                 |                                                                         |                    | **Default value**:                                                                                            |
   |                 |                                                                         |                    |                                                                                                               |
   |                 |                                                                         |                    | None                                                                                                          |
   +-----------------+-------------------------------------------------------------------------+--------------------+---------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__en-us_topic_0142814614_table14455523:

.. table:: **Table 2** Rule

   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                   | Type                                                                          | Mandatory (Yes/No) | Description                                                                                                                                                                                                                                                                                                                                                                                                           |
   +=============================+===============================================================================+====================+=======================================================================================================================================================================================================================================================================================================================================================================================================================+
   | id                          | str                                                                           | No                 | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Lifecycle rule ID                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Value range**:                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | The value must contain 1 to 255 characters.                                                                                                                                                                                                                                                                                                                                                                           |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | prefix                      | str                                                                           | Yes                | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Object name prefix. It identifies the objects the rule applies to. You can leave this parameter blank to apply the rule to all objects in the bucket.                                                                                                                                                                                                                                                                 |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Assume that you have the following objects: **logs/day1**, **logs/day2**, **logs/day3**, and **ExampleObject.jpg**. If you set **Prefix** to **ExampleObject.jpg**, the rule applies to object **ExampleObject.jpg** only. If you set **Prefix** to **logs/**, the rule applies to the three objects with name starting with **logs/**. If you leave **Prefix** blank, the rule applies to all objects in the bucket. |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Value range**:                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | The value must contain 1 to 1,024 characters.                                                                                                                                                                                                                                                                                                                                                                         |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                      | str                                                                           | Yes                | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Whether the rule is enabled                                                                                                                                                                                                                                                                                                                                                                                           |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Value range**:                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | -  **Enabled**                                                                                                                                                                                                                                                                                                                                                                                                        |
   |                             |                                                                               |                    | -  **Disabled**                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | transition                  | :ref:`Transition <obs_22_0821__en-us_topic_0142814685_table14455523>`         | No                 | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             | or                                                                            |                    | Policies for storage class transition, including transition time and the storage class after transition. For details, see :ref:`Table 3 <obs_22_0821__en-us_topic_0142814685_table14455523>`.                                                                                                                                                                                                                         |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             | list of :ref:`Transition <obs_22_0821__en-us_topic_0142814685_table14455523>` |                    | **Restrictions:**                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | This parameter applies only to the current object version.                                                                                                                                                                                                                                                                                                                                                            |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | expiration                  | :ref:`Expiration <obs_22_0821__en-us_topic_0142814588_table14455523>`         | No                 | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Object expiration time. For details, see :ref:`Table 4 <obs_22_0821__en-us_topic_0142814588_table14455523>`.                                                                                                                                                                                                                                                                                                          |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Restrictions:**                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | This parameter applies only to the current object version.                                                                                                                                                                                                                                                                                                                                                            |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | noncurrentVersionTransition | :ref:`NoncurrentVersionTransition <obs_22_0821__table97075943115>`            | No                 | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             | or                                                                            |                    | Policies for storage class transition, including transition time and the storage class after transition. For details, see :ref:`Table 7 <obs_22_0821__table97075943115>`.                                                                                                                                                                                                                                             |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             | list of :ref:`NoncurrentVersionTransition <obs_22_0821__table97075943115>`    |                    | **Restrictions:**                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | -  This parameter applies only to noncurrent object versions.                                                                                                                                                                                                                                                                                                                                                         |
   |                             |                                                                               |                    | -  Versioning is enabled (or suspended after being enabled) for the bucket.                                                                                                                                                                                                                                                                                                                                           |
   |                             |                                                                               |                    | -  This parameter is not available for parallel file systems.                                                                                                                                                                                                                                                                                                                                                         |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | noncurrentVersionExpiration | :ref:`NoncurrentVersionExpiration <obs_22_0821__table669515544314>`           | No                 | **Explanation:**                                                                                                                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | Expiration time of noncurrent object versions. For details, see :ref:`Table 8 <obs_22_0821__table669515544314>`.                                                                                                                                                                                                                                                                                                      |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Restrictions:**                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | -  This parameter applies only to noncurrent object versions.                                                                                                                                                                                                                                                                                                                                                         |
   |                             |                                                                               |                    | -  Versioning is enabled (or suspended after being enabled) for the bucket.                                                                                                                                                                                                                                                                                                                                           |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | .. caution::                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    |    CAUTION:                                                                                                                                                                                                                                                                                                                                                                                                           |
   |                             |                                                                               |                    |    This parameter is not available for parallel file systems.                                                                                                                                                                                                                                                                                                                                                         |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | **Default value**:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                             |                                                                               |                    |                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                             |                                                                               |                    | None                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------------+-------------------------------------------------------------------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__en-us_topic_0142814685_table14455523:

.. table:: **Table 3** Transition

   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type                                              | Mandatory (Yes/No)                                                         | Description                                                                                                                                                                                                                                       |
   +=================+===================================================+============================================================================+===================================================================================================================================================================================================================================================+
   | storageClass    | str                                               | Yes if used as a request parameter                                         | **Explanation:**                                                                                                                                                                                                                                  |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | Storage class of the object after transition                                                                                                                                                                                                      |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Restrictions:**                                                                                                                                                                                                                                 |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | -  The Standard storage class is not supported.                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | -  Restrictions on storage class transitions:                                                                                                                                                                                                     |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            |    -  Only transitions from the Standard storage class to the Warm storage class are supported. To transition objects from Warm to Standard, you must manually do it.                                                                             |
   |                 |                                                   |                                                                            |    -  Only transitions from the Standard or Warm storage class to the Cold storage class are supported. To transition objects from Cold to Standard or Warm, you must restore the objects first and then manually transition their storage class. |
   |                 |                                                   |                                                                            |    -  Multi-AZ redundancy is not available for Cold storage. For this reason, buckets or objects with multi-AZ redundancy cannot be transitioned to the Cold storage class based on a lifecycle rule.                                             |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Value range**:                                                                                                                                                                                                                                  |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | See :ref:`Table 5 <obs_22_0821__table98563310565>`.                                                                                                                                                                                               |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Default value**:                                                                                                                                                                                                                                |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | None                                                                                                                                                                                                                                              |
   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | date            | str                                               | Yes if the parameter is used as a request parameter and **days** is absent | **Explanation:**                                                                                                                                                                                                                                  |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 | or                                                |                                                                            | OBS executes the lifecycle rule for objects that were modified before the specified date.                                                                                                                                                         |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 | :ref:`DateTime <obs_22_0821__table2544102913299>` |                                                                            | **Restrictions:**                                                                                                                                                                                                                                 |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | The value must conform with the ISO8601 standards and indicate UTC 00:00. For example, **2018-01-01T00:00:00.000Z** indicates only objects that were last modified before the specified time are transitioned to the specified storage class.     |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | For example, **DateTime(year=2023, month=9, day=12)**                                                                                                                                                                                             |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Default value**:                                                                                                                                                                                                                                |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | None                                                                                                                                                                                                                                              |
   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | days            | int                                               | Yes if the parameter is used as a request parameter and **date** is absent | **Explanation:**                                                                                                                                                                                                                                  |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | Number of days (since the last update was made to the object) after which the lifecycle rule takes effect                                                                                                                                         |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Restrictions:**                                                                                                                                                                                                                                 |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | This parameter applies only to the current object version.                                                                                                                                                                                        |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Value range**:                                                                                                                                                                                                                                  |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | An integer greater than or equal to 0, in days                                                                                                                                                                                                    |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | **Default value**:                                                                                                                                                                                                                                |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                                                                   |
   |                 |                                                   |                                                                            | None                                                                                                                                                                                                                                              |
   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__en-us_topic_0142814588_table14455523:

.. table:: **Table 4** Expiration

   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type                                              | Mandatory (Yes/No)                                                         | Description                                                                                                                                                                                               |
   +=================+===================================================+============================================================================+===========================================================================================================================================================================================================+
   | date            | str                                               | Yes if the parameter is used as a request parameter and **days** is absent | **Explanation:**                                                                                                                                                                                          |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 | or                                                |                                                                            | OBS executes the lifecycle rule for objects that were modified before the specified date.                                                                                                                 |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 | :ref:`DateTime <obs_22_0821__table2544102913299>` |                                                                            | **Restrictions:**                                                                                                                                                                                         |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | The value must conform with the ISO8601 standards and indicate UTC 00:00. For example, **2018-01-01T00:00:00.000Z** indicates only objects that were last modified before the specified time are deleted. |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | For example, **DateTime(year=2023, month=9, day=12)**                                                                                                                                                     |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | **Default value**:                                                                                                                                                                                        |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | None                                                                                                                                                                                                      |
   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | days            | int                                               | Yes if the parameter is used as a request parameter and **date** is absent | **Explanation:**                                                                                                                                                                                          |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | Number of days (since the last update was made to the object) after which the lifecycle rule takes effect                                                                                                 |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | **Restrictions:**                                                                                                                                                                                         |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | This parameter applies only to the current object version.                                                                                                                                                |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | **Value range**:                                                                                                                                                                                          |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | An integer greater than or equal to 0, in days                                                                                                                                                            |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | **Default value**:                                                                                                                                                                                        |
   |                 |                                                   |                                                                            |                                                                                                                                                                                                           |
   |                 |                                                   |                                                                            | None                                                                                                                                                                                                      |
   +-----------------+---------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__table98563310565:

.. table:: **Table 5** StorageClass

   +-----------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                   | Description                                                                                                                                                                       |
   +=======================+========================+===================================================================================================================================================================================+
   | STANDARD              | Standard storage class | **Explanation:**                                                                                                                                                                  |
   |                       |                        |                                                                                                                                                                                   |
   |                       |                        | Features low access latency and high throughput and is used for storing massive, frequently accessed (multiple times a month) or small objects (< 1 MB) requiring quick response. |
   +-----------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | WARM                  | Warm storage class     | **Explanation:**                                                                                                                                                                  |
   |                       |                        |                                                                                                                                                                                   |
   |                       |                        | Used for storing data that is semi-frequently accessed (fewer than 12 times a year) but is instantly available when needed.                                                       |
   +-----------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | COLD                  | Cold storage class     | **Explanation:**                                                                                                                                                                  |
   |                       |                        |                                                                                                                                                                                   |
   |                       |                        | Used for storing rarely accessed (once a year) data.                                                                                                                              |
   +-----------------------+------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__table2544102913299:

.. table:: **Table 6** DateTime

   +-----------------------+-----------------------+---------------------------------+
   | Parameter             | Type                  | Description                     |
   +=======================+=======================+=================================+
   | year                  | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Year in UTC                     |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | None                            |
   +-----------------------+-----------------------+---------------------------------+
   | month                 | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Month in UTC                    |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | None                            |
   +-----------------------+-----------------------+---------------------------------+
   | day                   | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Day in UTC                      |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | None                            |
   +-----------------------+-----------------------+---------------------------------+
   | hour                  | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Hour in UTC                     |
   |                       |                       |                                 |
   |                       |                       | **Restrictions:**               |
   |                       |                       |                                 |
   |                       |                       | The value is in 24-hour format. |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | 0                               |
   +-----------------------+-----------------------+---------------------------------+
   | min                   | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Minute in UTC                   |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | 0                               |
   +-----------------------+-----------------------+---------------------------------+
   | sec                   | int                   | **Explanation:**                |
   |                       |                       |                                 |
   |                       |                       | Second in UTC                   |
   |                       |                       |                                 |
   |                       |                       | **Default value**:              |
   |                       |                       |                                 |
   |                       |                       | 0                               |
   +-----------------------+-----------------------+---------------------------------+

.. _obs_22_0821__table97075943115:

.. table:: **Table 7** NoncurrentVersionTransition

   +-----------------+-----------------+------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type            | Mandatory (Yes/No)                 | Description                                                                                                                                                                                                                                       |
   +=================+=================+====================================+===================================================================================================================================================================================================================================================+
   | storageClass    | str             | Yes if used as a request parameter | **Explanation:**                                                                                                                                                                                                                                  |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | Storage class of noncurrent object versions after transition                                                                                                                                                                                      |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Restrictions:**                                                                                                                                                                                                                                 |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | -  The Standard storage class is not supported.                                                                                                                                                                                                   |
   |                 |                 |                                    | -  Restrictions on storage class transitions:                                                                                                                                                                                                     |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    |    -  Only transitions from the Standard storage class to the Warm storage class are supported. To transition objects from Warm to Standard, you must manually do it.                                                                             |
   |                 |                 |                                    |    -  Only transitions from the Standard or Warm storage class to the Cold storage class are supported. To transition objects from Cold to Standard or Warm, you must restore the objects first and then manually transition their storage class. |
   |                 |                 |                                    |    -  Multi-AZ redundancy is not available for Cold storage. For this reason, buckets or objects with multi-AZ redundancy cannot be transitioned to the Cold storage class based on a lifecycle rule.                                             |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Value range**:                                                                                                                                                                                                                                  |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | See :ref:`Table 5 <obs_22_0821__table98563310565>`.                                                                                                                                                                                               |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Default value**:                                                                                                                                                                                                                                |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | None                                                                                                                                                                                                                                              |
   +-----------------+-----------------+------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | noncurrentDays  | int             | Yes if used as a request parameter | **Explanation:**                                                                                                                                                                                                                                  |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | Number of days an object is noncurrent before the specified rule takes effect                                                                                                                                                                     |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Restrictions:**                                                                                                                                                                                                                                 |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | This parameter applies only to noncurrent object versions.                                                                                                                                                                                        |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Value range**:                                                                                                                                                                                                                                  |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | An integer greater than or equal to 0, in days                                                                                                                                                                                                    |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | **Default value**:                                                                                                                                                                                                                                |
   |                 |                 |                                    |                                                                                                                                                                                                                                                   |
   |                 |                 |                                    | None                                                                                                                                                                                                                                              |
   +-----------------+-----------------+------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _obs_22_0821__table669515544314:

.. table:: **Table 8** NoncurrentVersionExpiration

   +-----------------+-----------------+------------------------------------+-------------------------------------------------------------------------------+
   | Parameter       | Type            | Mandatory (Yes/No)                 | Description                                                                   |
   +=================+=================+====================================+===============================================================================+
   | noncurrentDays  | int             | Yes if used as a request parameter | **Explanation:**                                                              |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | Number of days an object is noncurrent before the specified rule takes effect |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | **Restrictions:**                                                             |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | This parameter applies only to noncurrent object versions.                    |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | **Value range**:                                                              |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | An integer greater than or equal to 0, in days                                |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | **Default value**:                                                            |
   |                 |                 |                                    |                                                                               |
   |                 |                 |                                    | None                                                                          |
   +-----------------+-----------------+------------------------------------+-------------------------------------------------------------------------------+

Responses
---------

+-----------------------------------------------------+-----------------------------------+
| Type                                                | Description                       |
+=====================================================+===================================+
| :ref:`GetResult <obs_22_0821__table20121844173311>` | **Explanation:**                  |
|                                                     |                                   |
|                                                     | SDK common results                |
+-----------------------------------------------------+-----------------------------------+

.. _obs_22_0821__table20121844173311:

.. table:: **Table 9** GetResult

   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                                                                                                                                                      |
   +=======================+=======================+==================================================================================================================================================================================================================================================================================================+
   | status                | int                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | HTTP status code                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Value range**:                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | A status code is a group of digits ranging from 2\ *xx* (indicating successes) to 4\ *xx* or 5\ *xx* (indicating errors). It indicates the status of a response.                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | reason                | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Reason description.                                                                                                                                                                                                                                                                              |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | errorCode             | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Error code returned by the OBS server. If the value of **status** is less than **300**, this parameter is left blank.                                                                                                                                                                            |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | errorMessage          | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Error message returned by the OBS server. If the value of **status** is less than **300**, this parameter is left blank.                                                                                                                                                                         |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | requestId             | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Request ID returned by the OBS server                                                                                                                                                                                                                                                            |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | indicator             | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Error indicator returned by the OBS server.                                                                                                                                                                                                                                                      |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | hostId                | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Requested server ID. If the value of **status** is less than **300**, this parameter is left blank.                                                                                                                                                                                              |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | resource              | str                   | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Error source (a bucket or an object). If the value of **status** is less than **300**, this parameter is left blank.                                                                                                                                                                             |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | header                | list                  | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Response header list, composed of tuples. Each tuple consists of two elements, respectively corresponding to the key and value of a response header.                                                                                                                                             |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | body                  | object                | **Explanation:**                                                                                                                                                                                                                                                                                 |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | Result content returned after the operation is successful. If the value of **status** is larger than **300**, the value of **body** is null. The value varies with the API being called. For details, see :ref:`Bucket-Related APIs <obs_22_0800>` and :ref:`Object-Related APIs <obs_22_0900>`. |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | **Default value**:                                                                                                                                                                                                                                                                               |
   |                       |                       |                                                                                                                                                                                                                                                                                                  |
   |                       |                       | None                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Code Examples
-------------

This example configures a lifecycle rule for bucket **examplebucket**.

::

   from obs import ObsClient
   from obs import Expiration, NoncurrentVersionExpiration
   from obs import DateTime
   from obs import Rule
   from obs import Lifecycle
   import os
   import traceback

   # Obtain an AK and SK pair using environment variables or import the AK and SK pair in other ways. Using hard coding may result in leakage.
   # Obtain an AK and SK pair on the management console.
   ak = os.getenv("AccessKeyID")
   sk = os.getenv("SecretAccessKey")
   # (Optional) If you use a temporary AK and SK pair and a security token to access OBS, obtain them from environment variables.
   # security_token = os.getenv("SecurityToken")
   # Set server to the endpoint of the region where the bucket is located.
   server = "https://your-endpoint"

   # Create an obsClient instance.
   # If you use a temporary AK and SK pair and a security token to access OBS, you must specify security_token when creating an instance.
   obsClient = ObsClient(access_key_id=ak, secret_access_key=sk, server=server)
   try:
       # Configure a lifecycle rule for deleting objects with prefix1 as the prefix after 60 days since the last update.
       rule1 = Rule(id='rule1', prefix='prefix1', status='Enabled', expiration=Expiration(days=60))
       # Configure a lifecycle rule for deleting objects with prefix2 as the prefix on December 31, 2023.
       rule2 = Rule(id='rule2', prefix='prefix2', status='Enabled', expiration=Expiration(date=DateTime(2023, 12, 31)))
       lifecycle = Lifecycle(rule=[rule1, rule2])
       bucketName="examplebucket"
       # Configures the lifecycle rules for the bucket.
       resp = obsClient.setBucketLifecycle(bucketName, lifecycle)
       # If status code 2xx is returned, the API is called successfully. Otherwise, the API call fails.
       if resp.status < 300:
           print('Set Bucket Lifecycle Succeeded')
           print('requestId:', resp.requestId)
       else:
           print('Set Bucket Lifecycle Failed')
           print('requestId:', resp.requestId)
           print('errorCode:', resp.errorCode)
           print('errorMessage:', resp.errorMessage)
   except:
       print('Set Bucket Lifecycle Failed')
       print(traceback.format_exc())
